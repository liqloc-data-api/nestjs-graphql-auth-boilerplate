{
    "QUERY": {
        "GET_ORDER_BY_ORDER_TYPES": "select so.*, ost.order_subtype_name, ot.order_type_id, ot.order_type_name, u.email as updated_by_email from session.session_orders so join iam.users u ON u.user_id = so.updated_by join session.order_subtypes ost on ost.order_subtype_id = so.order_subtype_id join session.order_types ot on ost.order_type_id = ot.order_type_id where ot.order_type_id = Any($4) and so.trader_id = $3 and so.book_id = $2  and so.session_id = $1 and not so.deleted",
        "GET_ORDER_BY_ORDER_TYPES_BOOK": "select so.*, ost.order_subtype_name, ot.order_type_id, ot.order_type_name, u.email as updated_by_email from session.session_orders so join iam.users u ON u.user_id = so.updated_by join session.order_subtypes ost on ost.order_subtype_id = so.order_subtype_id join session.order_types ot on ost.order_type_id = ot.order_type_id where ot.order_type_id = Any($3) and so.book_id = $2  and so.session_id = $1 and not so.deleted",
        "GET_ORDER_BY_ID": "select so.order_id, so.order_subtype_id, ost.order_subtype_name, ot.order_type_id, ot.order_type_name, so.session_id, so.book_id, so.trader_id, so.order_key, so.order_members, so.custom_members , so.updated_by, u.email as updated_by_email, so.updated_at from session.session_orders so join iam.users u ON u.user_id = so.updated_by join session.order_subtypes ost on ost.order_subtype_id = so.order_subtype_id join session.order_types ot on ost.order_type_id = ot.order_type_id where so.order_id = $4 and so.trader_id = $3 and so.book_id = $2  and so.session_id = $1 and not so.deleted",
        "GET_ORDER_BY_ORDER_SUBTYPE_AND_ID": "select order_id from session.session_orders where session_id = $1 and book_id = $2 and trader_id = $3 and order_subtype_id = $4 and order_id =$5 and not deleted",
        "GET_ORDER_SUBTYPES": "select order_subtype_id, order_subtype_name from session.order_subtypes where not deleted",
        "GET_ORDER_DETAILS_BY_ORDER_ID": "select sod.order_id, so.session_id, so.book_id, so.trader_id, sod.instrument_id, sod.order_detail_members, sod.custom_members, sod.updated_by, sod.updated_at, u.email as updated_by_email from session.session_order_details sod join session.session_orders so on so.order_id = sod.order_id join iam.users u on u.user_id = sod.updated_by where sod.order_id = $4 and so.session_id = $1 and so.book_id = $2 and so.trader_id = $3 and not so.deleted and not sod.deleted",
        "GET_ORDER_DETAILS_BY_BOOK": "select sod.order_id, so.session_id, so.book_id, so.trader_id, sod.instrument_id, sod.order_detail_members, sod.custom_members, sod.updated_by, sod.updated_at, u.email as updated_by_email from session.session_order_details sod join session.session_orders so on so.order_id = sod.order_id join iam.users u on u.user_id = sod.updated_by where so.session_id = $1 and so.book_id = $2 and not so.deleted and not sod.deleted",
        "GET_ORDER_DETAILS_BY_INSTRUMENT_ID": "select sod.order_id, so.session_id, so.book_id, so.trader_id, sod.instrument_id, sod.order_detail_members, sod.custom_members, sod.updated_by, sod.updated_at, u.email as updated_by_email from session.session_order_details sod join session.session_orders so on so.order_id = sod.order_id join iam.users u on u.user_id = sod.updated_by where sod.order_id = $4 and sod.instrument_id = $5 and so.session_id = $1 and so.book_id = $2 and so.trader_id = $3 and not so.deleted and not sod.deleted"
    },
    "ADD": {
        "ADD_ORDER": "insert into session.session_orders (order_subtype_id, session_id, book_id, trader_id, order_key, order_members, custom_members, updated_by) values ($1, $2, $3, $4, $5, $6, $7, $8) returning *",
        "ADD_MULTI_ORDERS": "insert into session.session_orders (session_id, book_id, trader_id, order_subtype_id, order_key, order_members, custom_members, updated_by) values {placeholder} returning *",
        "ADD_ORDER_DETAIL": "insert into session.session_order_details (order_id, session_id, instrument_id, order_detail_members, custom_members, updated_by) values ($1, $2, $3, $4, $5, $6) returning *",
        "ADD_MULTI_ORDER_DETAILS": "insert into session.session_order_details (order_id, session_id, instrument_id, order_detail_members, custom_members, updated_by) values {placeholder} returning *"
    },
    "UPDATE": {
        "UPDATE_ORDER": "update session.session_orders set order_key = $5, order_members = $6, custom_members = $7, updated_by = $8 where order_id = $4 and trader_id = $3 and book_id = $2  and session_id = $1 and not deleted returning *",
        "UPDATE_ORDER_DETAILS": "update session.session_order_details sod set order_detail_members = $7::jsonb, custom_members = $8, updated_by = $9  From session.session_orders so where sod.order_id = so.order_id and so.session_id = $1 and so.book_id = $2 and so.trader_id = $3 and so.order_id = $4 and so.order_subtype_id = $5 and sod.instrument_id = $6 and not sod.deleted returning sod.*"
    },
    "DELETE": {
        "DELETE_ORDER_BY_IDS": "update session.session_orders set deleted = true, updated_by = $5 where order_id = Any($4) and trader_id = $3 and book_id = $2  and session_id = $1 and not deleted returning *",
        "DELETE_ALL_ORDERS_BY_TYPE_IDS": "update session.session_orders as so set deleted = true, updated_by = $5 from session.order_subtypes as os where os.order_subtype_id = so.order_subtype_id and os.order_type_id = Any($4) and so.trader_id = $3 and so.book_id = $2  and so.session_id = $1 and not so.deleted returning *",
        "DELETE_ORDER_DETAILS_BY_INSTRUMENT_IDS": "update session.session_order_details sod set deleted = true, updated_by = $6 from session.session_orders so where so.order_id = sod.order_id and sod.order_id = $4 and so.trader_id = $3 and so.book_id = $2 and so.session_id = $1 and sod.instrument_id = Any($5) and not sod.deleted returning *",
        "DELETE_ALL_ORDER_DETAILS_BY_ORDER_ID": "update session.session_order_details sod set deleted = true, updated_by = $5 from session.session_orders so where so.order_id = sod.order_id and sod.order_id = $4 and so.trader_id = $3 and so.book_id = $2 and so.session_id = $1 and not sod.deleted returning *",
        "DELETE_ORDERS_CUSTOM_COLUMN": "update session.session_orders AS so set custom_members = COALESCE(custom_members #-ARRAY[$5]::text[], custom_members), updated_by = -$6 from session.order_subtypes AS os where os.order_subtype_id = so.order_subtype_id and os.order_type_id = $4 and so.trader_id = $3 and so.book_id = $2 and so.session_id = $1 returning *",
        "DELETE_ORDER_DETAILS_CUSTOM_COLUMN": "update session.session_order_details sod set custom_members = COALESCE(custom_members #-ARRAY[$5]::text[], custom_members), updated_by = $6 from session.session_orders so where so.order_id = sod.order_id and sod.order_id = $4 and trader_id = $3 and so.book_id = $2 and so.session_id = $1 RETURNING *"
    }
}
